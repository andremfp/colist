import{s as ae,n as G,r as z,c as ie,o as ne,a as re,d as oe,t as de}from"../chunks/scheduler.BRxxf2Ee.js";import{S as ce,i as ue,e as I,s as V,t as j,c as v,a as T,k as J,d as _,f as F,b as q,l as c,g as H,h as p,m as O,j as R,r as Q,n as Y}from"../chunks/index.CxS-fQ88.js";import{e as Z,u as fe,s as he,d as me}from"../chunks/index.esm.CYeVeADr.js";import{c as pe,e as _e,g as be,u as x,h as ge,i as ke}from"../chunks/api.DQtzI3KZ.js";import{p as we}from"../chunks/stores.cQIdjFTD.js";import{g as $}from"../chunks/entry.Dqh1kYlX.js";import{s as W,g as ye,a as K}from"../chunks/utils.CPHkvh9i.js";import{a as Ie}from"../chunks/firebase.CIecg0m3.js";function ee(u,e,t){const l=u.slice();return l[24]=e[t],l[26]=t,l}function te(u){let e,t,l=[],n=new Map,s=Z(u[0]);const w=i=>i[24].id;for(let i=0;i<s.length;i+=1){let d=ee(u,s,i),b=w(d);n.set(b,l[i]=se(b,d))}return{c(){e=I("div"),t=I("ul");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=v(i,"DIV",{class:!0});var d=T(e);t=v(d,"UL",{class:!0});var b=T(t);for(let h=0;h<l.length;h+=1)l[h].l(b);b.forEach(_),d.forEach(_),this.h()},h(){c(t,"class","space-y-2"),c(e,"class","rounded-xl shadow-ios p-4 overflow-hidden bg-lists-bg-light dark:bg-lists-bg-dark")},m(i,d){H(i,e,d),p(e,t);for(let b=0;b<l.length;b+=1)l[b]&&l[b].m(t,null)},p(i,d){d&1517&&(s=Z(i[0]),l=fe(l,d,w,1,i,s,n,t,me,se,null,ee))},d(i){i&&_(e);for(let d=0;d<l.length;d+=1)l[d].d()}}}function ve(u){let e,t=u[24].name+"",l;return{c(){e=I("span"),l=j(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var s=T(e);l=q(s,t),s.forEach(_),this.h()},h(){c(e,"class","flex-grow")},m(n,s){H(n,e,s),p(e,l)},p(n,s){s&1&&t!==(t=n[24].name+"")&&R(l,t)},d(n){n&&_(e)}}}function Ee(u){let e,t,l;return{c(){e=I("input"),this.h()},l(n){e=v(n,"INPUT",{id:!0,type:!0,class:!0}),this.h()},h(){c(e,"id","new-item-input"),c(e,"type","text"),c(e,"class","new-list-item flex-grow p-2 border-2 border-input-border-light dark:border-input-border-dark bg-input-bg-light dark:bg-input-bg-dark text-input-text-light dark:text-input-text-dark rounded-lg")},m(n,s){H(n,e,s),Y(e,u[2]),t||(l=[O(e,"input",u[14]),O(e,"keydown",u[10])],t=!0)},p(n,s){s&4&&e.value!==n[2]&&Y(e,n[2])},d(n){n&&_(e),t=!1,z(l)}}}function le(u){let e;return{c(){e=I("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),T(e).forEach(_),this.h()},h(){c(e,"class","border-t border-border-light dark:border-border-dark mt-2")},m(t,l){H(t,e,l)},d(t){t&&_(e)}}}function se(u,e){let t,l,n,s,w,i,d,b,h,E,m,B,C,S,A,U;function D(...f){return e[13](e[24],...f)}function P(f,g){return f[3]&&f[26]===f[0].length-1?Ee:ve}let M=P(e),y=M(e);function k(){return e[15](e[24])}function L(...f){return e[16](e[24],...f)}let r=e[0].length-1!==e[26]&&le();return{key:u,first:null,c(){t=I("li"),l=I("div"),n=I("label"),s=I("input"),d=V(),y.c(),h=V(),E=I("button"),m=j("Delete"),C=V(),r&&r.c(),S=Q(),this.h()},l(f){t=v(f,"LI",{class:!0});var g=T(t);l=v(g,"DIV",{class:!0,style:!0});var a=T(l);n=v(a,"LABEL",{class:!0});var o=T(n);s=v(o,"INPUT",{type:!0,class:!0}),d=F(o),y.l(o),o.forEach(_),a.forEach(_),h=F(g),E=v(g,"BUTTON",{class:!0,style:!0,"aria-label":!0});var N=T(E);m=q(N,"Delete"),N.forEach(_),g.forEach(_),C=F(f),r&&r.l(f),S=Q(),this.h()},h(){c(s,"type","checkbox"),c(s,"class","flex-shrink-0 h-5 w-5 appearance-none cursor-pointer border-2 border-add-item bg-lists-bg-light dark:bg-lists-bg-dark checked:bg-add-item dark:checked:bg-add-item mr-4 rounded focus:ring-0"),s.checked=w=e[24].checked,s.disabled=i=e[3]&&e[26]===e[0].length-1,c(n,"class","flex items-center w-full"),c(l,"class","list-item-content flex items-center w-full transition-transform duration-300 ease-in-out"),c(l,"style",b=`transform: translateX(${e[5]===e[24].id?`-${X}px`:"0"});`),c(E,"class","delete-btn absolute top-0 bottom-0 right-0 py-1 px-4 text-white shadow-lg bg-delete-btn transition-transform duration-300 ease-in-out"),c(E,"style",B=`width: ${X}px; transform: translateX(${e[5]===e[24].id?"0":`${X}px`});`),c(E,"aria-label","Delete item"),c(t,"class","relative flex items-center p-2 bg-lists-bg-light dark:bg-lists-bg-dark rounded-lg overflow-hidden"),this.first=t},m(f,g){H(f,t,g),p(t,l),p(l,n),p(n,s),p(n,d),y.m(n,null),p(t,h),p(t,E),p(E,m),H(f,C,g),r&&r.m(f,g),H(f,S,g),A||(U=[O(s,"click",D),O(E,"click",k),oe(he.call(null,t,{timeframe:300,minSwipeDistance:60})),O(t,"swipe",L)],A=!0)},p(f,g){e=f,g&1&&w!==(w=e[24].checked)&&(s.checked=w),g&9&&i!==(i=e[3]&&e[26]===e[0].length-1)&&(s.disabled=i),M===(M=P(e))&&y?y.p(e,g):(y.d(1),y=M(e),y&&(y.c(),y.m(n,null))),g&33&&b!==(b=`transform: translateX(${e[5]===e[24].id?`-${X}px`:"0"});`)&&c(l,"style",b),g&33&&B!==(B=`width: ${X}px; transform: translateX(${e[5]===e[24].id?"0":`${X}px`});`)&&c(E,"style",B),e[0].length-1!==e[26]?r||(r=le(),r.c(),r.m(S.parentNode,S)):r&&(r.d(1),r=null)},d(f){f&&(_(t),_(C),_(S)),y.d(),r&&r.d(f),A=!1,z(U)}}}function Le(u){let e,t,l,n='<span class="ri-arrow-left-s-line text-icon-lg mr-2"></span> My Lists',s,w,i=u[1].name+"",d,b,h,E,m,B=(u[4].length>0?u[4].join(", "):"No one")+"",C,S,A,U,D,P=`<span class="ri-add-line text-icon-lg"></span>
			Add Item`,M,y,k=u[0].length>0&&te(u);return{c(){e=I("div"),t=I("div"),l=I("button"),l.innerHTML=n,s=V(),w=I("h1"),d=j(i),b=V(),h=I("h3"),E=j("Shared with: "),m=I("span"),C=j(B),S=V(),k&&k.c(),A=V(),U=I("div"),D=I("button"),D.innerHTML=P,this.h()},l(L){e=v(L,"DIV",{class:!0});var r=T(e);t=v(r,"DIV",{class:!0});var f=T(t);l=v(f,"BUTTON",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-1y0yq1q"&&(l.innerHTML=n),f.forEach(_),s=F(r),w=v(r,"H1",{class:!0});var g=T(w);d=q(g,i),g.forEach(_),b=F(r),h=v(r,"H3",{class:!0});var a=T(h);E=q(a,"Shared with: "),m=v(a,"SPAN",{class:!0});var o=T(m);C=q(o,B),o.forEach(_),a.forEach(_),S=F(r),k&&k.l(r),A=F(r),U=v(r,"DIV",{class:!0});var N=T(U);D=v(N,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),J(D)!=="svelte-1wemaxt"&&(D.innerHTML=P),N.forEach(_),r.forEach(_),this.h()},h(){c(l,"class","flex items-center text-lg font-bold"),c(t,"class","flex items-center mb-6"),c(w,"class","text-3xl font-bold mb-6"),c(m,"class","font-normal"),c(h,"class","text-sm font-bold mb-6"),c(D,"class","add-item text-add-item text-base font-normal flex items-center"),c(D,"aria-label","Add new item"),c(U,"class","mt-4"),c(e,"class","p-4 bg-main-bg-light dark:bg-main-bg-dark text-text-light dark:text-text-dark")},m(L,r){H(L,e,r),p(e,t),p(t,l),p(e,s),p(e,w),p(w,d),p(e,b),p(e,h),p(h,E),p(h,m),p(m,C),p(e,S),k&&k.m(e,null),p(e,A),p(e,U),p(U,D),M||(y=[O(l,"click",u[11]),O(D,"click",u[9])],M=!0)},p(L,[r]){r&2&&i!==(i=L[1].name+"")&&R(d,i),r&16&&B!==(B=(L[4].length>0?L[4].join(", "):"No one")+"")&&R(C,B),L[0].length>0?k?k.p(L,r):(k=te(L),k.c(),k.m(e,A)):k&&(k.d(1),k=null)},i:G,o:G,d(L){L&&_(e),k&&k.d(),M=!1,z(y)}}}const X=100;function De(u,e,t){let l,n;ie(u,we,a=>t(12,n=a));let s=[],w={id:"",name:"",ownerId:"",sharedBy:[],itemCount:0},i="",d="",b=!0,h=!1,E=[],m=null;ne(async()=>{try{Ie.onAuthStateChanged(async a=>{if(a){d=a.uid;const[o,N]=await Promise.all([pe(l),_e(l)]);o&&(t(0,s=o),W(s)),N&&(t(1,w=N),t(4,E=await ye(w.sharedBy,d))),b=!1}else console.log("User not detected, redirecting to login"),$("/")}),document.addEventListener("click",D)}catch(a){console.error("Failed to fetch list details:",a)}}),re(()=>{typeof document<"u"&&document.removeEventListener("click",D)});async function B(){if(!i.trim())return y();try{const a=await ge({name:i,listId:l,addedBy:d,checked:!1});s.pop(),t(0,s=[...s,a]),await x(l,{itemCount:s.length}),W(s)}catch(a){console.error("Error adding item:",a),K("Failed to add item.")}finally{t(2,i=""),t(3,h=!1)}}async function C(a){try{await be(a.id),t(0,s=s.filter(o=>o.id!==a.id)),await x(l,{itemCount:s.length})}catch(o){console.error("Error deleting item:",o),K("Failed to delete item.")}}async function S(a){try{const o=await ke(a.id,{checked:!a.checked});t(0,s=s.map(N=>N.id===o?{...N,checked:!N.checked}:N)),W(s)}catch(o){console.error("Error updating item:",o),K("Failed to update item.")}}function A(a,o){a.detail.direction==="left"?t(5,m=o):a.detail.direction==="right"&&m===o&&t(5,m=null)}async function U(a,o){if(h){a.preventDefault();return}if(m!==null){m!==l&&t(5,m=null),a.preventDefault();return}await S(o)}function D(a){const o=a.target;!o.closest(".new-list-item")&&!o.closest(".delete-btn")&&!o.closest(".add-item")&&(h&&(y(),a.preventDefault()),t(5,m=null)),o.closest(".new-list-item")&&m!==null&&t(5,m=null)}function P(){h||(t(3,h=!0),t(5,m=null),t(0,s=[...s,{id:"",name:"",listId:"",addedBy:"",checked:!1}]),de().then(()=>{var a;return(a=document.getElementById("new-item-input"))==null?void 0:a.focus()}))}function M(a){a.key==="Enter"&&B(),a.key==="Escape"&&y()}function y(){s.pop(),t(2,i=""),t(3,h=!1)}function k(){$("/lists")}const L=(a,o)=>U(o,a);function r(){i=this.value,t(2,i)}const f=a=>C(a),g=(a,o)=>A(o,a.id);return u.$$.update=()=>{u.$$.dirty&4096&&(l=n.params.id)},[s,w,i,h,E,m,C,A,U,P,M,k,n,L,r,f,g]}class He extends ce{constructor(e){super(),ue(this,e,De,Le,ae,{})}}export{He as component};
